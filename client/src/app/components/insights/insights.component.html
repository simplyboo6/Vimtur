<div *ngIf="insights; else loading" class="insights">
  <ngb-tabset>
    <ngb-tab title="Overview">
      <ng-template ngbTabContent>
        <p class="pad-top">
          Insights are metrics generated based upon tagged and rated data.
        </p>
        <p>
          They're generated by calculating the average rating you give media with the given tag.
          This data is then used to generate recommendations (see 'Sort By' in Search).
        </p>
        <p>
          The data in these tabs will show the average ratings calculated. This can give Insight
          into the things you like and dislike.
        </p>
        <p>
          Note that before rating a good amount of media this section (and sorting by recommended
          will not be very useful).
        </p>
      </ng-template>
    </ngb-tab>
    <ngb-tab title="Tags">
      <ng-template ngbTabContent>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Tag</th>
              <th scope="col">Average Rating</th>
              <th scope="col">Media Count</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let tag of insights.tags">
              <td>{{ tag.name }}</td>
              <td>{{ (tag.average * 2 + 3).toFixed(2) }}</td>
              <td>{{ tag.count }}</td>
            </tr>
          </tbody>
        </table>
      </ng-template>
    </ngb-tab>

    <ngb-tab title="Actors">
      <ng-template ngbTabContent>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Actor</th>
              <th scope="col">Average Rating</th>
              <th scope="col">Media Count</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let actor of insights.actors">
              <td>{{ actor.name }}</td>
              <td>{{ (actor.average * 2 + 3).toFixed(2) }}</td>
              <td>{{ actor.count }}</td>
            </tr>
          </tbody>
        </table>
      </ng-template>
    </ngb-tab>

    <ngb-tab title="Artists">
      <ng-template ngbTabContent>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Artist</th>
              <th scope="col">Average Rating</th>
              <th scope="col">Media Count</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let artist of insights.artists">
              <td>{{ artist.name }}</td>
              <td>{{ (artist.average * 2 + 3).toFixed(2) }}</td>
              <td>{{ artist.count }}</td>
            </tr>
          </tbody>
        </table>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>
</div>

<ng-template #loading>
  <div class="loading">
    Generating and loading insights...
    <ngb-progressbar type="info" [value]="100" [striped]="true" [animated]="true"></ngb-progressbar>
  </div>
</ng-template>
